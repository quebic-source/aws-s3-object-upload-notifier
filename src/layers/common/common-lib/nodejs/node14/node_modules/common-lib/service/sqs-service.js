const AWS = require('aws-sdk');

class SQSService {
    constructor() {
        this.sqs = new AWS.SQS();
    }

    pushMessage(QueueUrl, {
        MessageBody,
        MessageAttributes= {},
        DelaySeconds = 0,
        MessageDeduplicationId,
        MessageGroupId
    }) {
        const params = {
            DelaySeconds,
            MessageAttributes,
            MessageBody,
            MessageDeduplicationId,  // Required for FIFO queues
            MessageGroupId,  // Required for FIFO queues
            QueueUrl
        };
        return this.sqs.sendMessage(params).promise();
    }
}

module.exports = SQSService;